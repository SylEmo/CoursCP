<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="robots" content="noindex">
	<title>Détails du projet - Adopi</title>
	<link rel="stylesheet" href="lib/foundation/css/foundation.min.css">
	<link rel="stylesheet" href="./css/adopi.css">
	<link rel="stylesheet" href="css/details-projet.css">
</head>
<body>
	<button class="btn btn-primary" onclick="document.location.href='liste-projets.html'">
		Retour accueil
	</button>
	
	<h1 id="nom_projet">Détails du projet : </h1>
	<button onclick="modifierProjet()">Modifier</button>
	<hr>
	<h2 id="date_creation">Date de création du projet : </h2>
	<h2 id="deadline">Deadline fixée : </h2>
	<h2><a onclick="ouvrirBacklog()">Accéder au backlog</a></h2>
	<h2 id="git">Fichier Git lié au projet : </h2>
	<h2 id="commit"><a onclick="ouvrirListeCommits()">Accéder à la liste des commits</a></h2>
	<h2><a onclick="ouvrirListeSprints()">Accéder aux sprints</a></h2>
	<h2>Burndown Chart actuel et prévisionnel</h2>
	<img id="imgburndown" src="" width="400" height="300"/>

	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
	<script type="text/javascript" src="./lib/foundation/js/foundation.min.js"></script>
    <script type="text/javascript" src="./js/verif_session.js"></script>
	<script type="text/javascript" src="./js/adopi.js"></script>
	
	<script>
		$(window).load(function(){
			verifSession();
			remplirsource();
			$.ajax({
				url: './php/RemplirDetailsProjet.php', //toujours la même page qui est appelée
				type: 'POST',
				data: {id: idProjet},
				success: function(data) {
					projet = data.split("\\|/");
					if(!projet[0]){
					}else{
						//document.getElementById('nom_projet').value=projet[0];
						$('#nom_projet').append(projet[0]);
						$('#date_creation').append(projet[1]);
						$('#deadline').append(projet[2]);
						if(projet[3] && projet[4]){
							$('#git').append("OUI");
						}else{
							$('#git').append("NON");
							document.getElementById('commit').style.display='none';
						}
					}
				}
			});
		});
		
		var idProjet = recupererIdProjetURL();
		
		var modifierProjet = function(){
			document.location.href="modifier-projet.html?id=" + idProjet;
		}
		var ouvrirBacklog = function(){
			document.location.href="backlog.html?id=" + idProjet;
		}
		var ouvrirListeCommits = function(){
			document.location.href="liste-commits.html?id=" + idProjet;
		}
		var ouvrirListeSprints = function(){
			document.location.href="liste-sprints.html?id=" + idProjet;
		}
		var remplirsource = function(){
			 document.getElementById('imgburndown').src="./php/BurndownChartControleur.php?id=" + idProjet;
		}
	</script>

</body>
</html>