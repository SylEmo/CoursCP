<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="robots" content="noindex">
	<title>Kanban sprint n°XX - Adopi</title>
	<link rel="stylesheet" href="lib/foundation/css/foundation.min.css">
	<link rel="stylesheet" href="css/kanban.css">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    	<script type="text/javascript" src="js/kanban.js"></script>
	<script type="text/javascript" src="./js/adopi.js"></script>
	<script type="text/javascript" src="./js/verif_session.js"></script>

</head>
<body>
	<h1>Kanban du sprint n°XX - NomDuProjet</h1>
	
    <menu>
		<button onclick="add_developer();">Ajouter un développeur</button>
		<button onclick="remove_developer();">Supprimer un dévelopeur</button>
		<button onclick="add_task();">Ajouter une tâche</button>
		<button onclick="remove_task();">Supprimer une tâche</button>
		<button onclick="add_status();">Ajouter un état</button>
		<button onclick="remove_status();">Supprimer un état</button>
    </menu>
    
    <div id="board">
    	<div id="hidden" hidden>
    		<h1 class ="title"> Rob</h1>
            <div class ="todo droptarget">
                <h2 class = "title"> To Do</h1>
                <a id="item1" draggable="true" href="#">
				    <div class="cardTitle">hidden</div>
				</a>
            </div>
            <div class ="inprogress droptarget">
                <h2 class = "title"> In Progress</h1>
            </div>
            <div class ="done droptarget">
                <h2 class = "title"> Done</h1>
            </div>
    	</div>
    </div>
    
    <div id="kanban">
    </div>

    <script type="text/javascript">
	    var idSprint = recupererIdProjetURL();

	    $('document').ready(init);
	    function init(){
			$('#board').bind('dragstart', function(event) {
	            event.originalEvent.dataTransfer.setData("Text", $(event.target).closest('a[id]').attr('id'));
	        });
	        // bind the dragover event on the board sections
	        $('#board').bind('dragover', function(event) {
			    if ($(event.target).closest('.droptarget').hasClass('droptarget')) {
					event.preventDefault();
		    	}
	        }).bind('drop', function(event) {
			    var notecard = event.originalEvent.dataTransfer.getData("Text");
			    var drop = $(event.target).closest('.droptarget');
			    drop.append($('#' + notecard));
			    // Turn off the default behaviour
			    // without this, FF will try and go to a URL with your id's name
			    event.preventDefault();
	        }).bind('click', function(event) {event.preventDefault();} );
	    }

		$(window).load(function(){
			verifSession();
			$.ajax({
				url: './php/RemplirKanban.php', //toujours la même page qui est appelée
				type: 'POST',
				data: {id: idSprint}, // paramètre fonction qui détermine la fonction qui sera exécutée
				success: function(data) {
					document.getElementById('kanban').innerHTML +=data;
				}
	   		});		
	    });
   </script>
</body>
</html>